
<!doctype html>
    <head>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
            ga('create', 'UA-98263199-1', 'auto');
            ga('send', 'pageview');
        </script>
    
        <title>GRAMPA - Count</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">	
        <!-- <link type="text/css" rel="stylesheet" href="css/pure.css"  media="screen,projection" /> -->
        <link type="text/css" rel="stylesheet" href="css/grid.css"  media="screen,projection" />
        <link type="text/css" rel="stylesheet" href="css/scaffold.css"  media="screen,projection" />
        <link rel='shortcut icon' href='img/favicon.ico' type='image/x-icon'/ >
    </head>

<body>
    	<!-- Desktop nav menu -->
	<div class="row" id="desktop-nav">
		<div class="col-3-24" id="margin"></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="index.html">Home</a></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="about.html">About</a></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="readme.html">README</a></div>
		
		<div class="col-3-24 dropdown" id="nav-link-cell">
			<a href="#" class="nav-link">Examples&#x21b4;</a>
			<div class="dropdown_container">
				<div class="dropdown_list_item"><a href="example1.html" class="nav-link-drop">&#x26AC; Identify mode of polyploidy</a></div>
				<div class="dropdown_list_item"><a href="example2.html" class="nav-link-drop">&#x26AC; Place WGD on phylogeny</a></div>
				<div class="dropdown_list_item"><a href="#" class="nav-link-drop">&#x26AC; Count duplications and losses</a></div>
			</div>
		</div>

		<div class="col-3-24 dropdown" id="nav-link-cell">
			<a href="#" class="nav-link">Results&#x21b4;</a>
			<div class="dropdown_container">
				<div class="dropdown_list_item"><a href="results/yeast/yeast.html" class="nav-link-drop">&#x26AC; Baker's Yeast</a></div>
				<div class="dropdown_list_item"><a href="results/wheat/wheat_all.html" class="nav-link-drop">&#x26AC; Bread Wheat</a></div>
				<div class="dropdown_list_item"><a href="performance.html" class="nav-link-drop">&#x26AC; Performance</a></div>
			</div>
		</div>

		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="links.html">Links</a></div>
	
		<div class="col-3-24" id="margin"></div>
	</div>
	<!-- Desktop nav menu -->

	<!-- Mobile nav menu -->
	<div class="row" id="mobile_nav">
		<div class="col-24-24 dropdown" id="nav_link_cell">
			<a href="#" class="nav_link"><img id="mobile_logo_nav" src="img/nav.png"></a> <span id="nav-text">Navigation</span>
			<div class="dropdown_container mobile_drop">
				<div class="dropdown_list_item"><a href="index.html" id="mobile_nav_link" id="active_drop">Home</a></div>
				<div class="dropdown_list_item"><a href="about.html" id="mobile_nav_link">About</a></div>
				<div class="dropdown_list_item"><a href="readme.html" id="mobile_nav_link">README</a></div>
				<div class="dropdown_list_item"><a href="https://github.com/gwct/grampa" target="_blank" id="mobile_nav_link">Download</a></div>
				<div class="dropdown_list_item"><a href="example1.html" id="mobile_nav_link">Example: Identify polyploidy</a></div>
				<div class="dropdown_list_item"><a href="example2.html" id="mobile_nav_link">Example: Place WGD on phylogeny</a></div>
				<div class="dropdown_list_item"><a href="#" id="mobile_nav_link">Example: Count dups and losses</a></div>
				<div class="dropdown_list_item"><a href="links.html" id="mobile_nav_link">Other links</a></div>
			</div>
		</div>  
	</div>
	<!-- Mobile nav menu -->

	<div class="row" id="main_row">
		<div class="col-3-24" id="margin"></div>
		<div class="col-18-24" id="main_col">
			<div id="main_content">

				<h1>Count duplications and losses in the presence of polyploidy</h1>

				<h4>Below are the inputs, commands, and outputs to do an analysis with GRAMPA to count the number of duplications and losses in a set of gene trees
					in the presence of polyploidy. The inputs are based on simulated data. For more detailed info on the simulations check
					<a href="https://doi.org/10.1093/sysbio/syx044" target="_blank">our paper</a>.</h4>
                    
				<div id="msg-cont">
					<div id="msg">
						<div id="msg-banner">Note</div>
						<div id="msg-text">
							<p>
								The examples below call GRAMPA as <code class="inline">grampa</code> assuming it has been installed from bioconda. If you installed
								from source, see <a href="readme.html#source">usage details in the README</a>.
							</p>
							<p></p>
						</div>
					</div>
				</div>                
                
				<div class="sep-div-2"></div>  

				<h3>Inputs</h3>

				<p>Suppose a hybridization event between the B and C lineages leading to the allopolyploid x,y,z clade. The MUL-tree representing this
					scenario is:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex3/mul_tree.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>								

				<p>GRAMPA can accurately count duplications and losses with this MUL-tree as input.</p>

				<ol>
					<li>MUL-tree: <a href="example_data/ex3/mul_tree_74_3a.tre" download>mul_tree_74_3a.tre</a></li>
					<li>Gene trees from your set of species (in this case 1000 gene trees simulated with gain and loss) : 
						<a href="example_data/ex3/gene_trees_3a.txt" download>gene_trees_3a.txt</a></li>
				</ol>

				<h3>GRAMPA command</h3>

				<p>With a known polyploidy scenario (MUL-tree), we can simply reconcile to that MUL-tree:</p>

				<center><pre class="cmd"><code>grampa -s mul_tree_74_3a.tre -g gene_trees_3a.txt -o ex3-output -f count-test --multree</code></pre></center>

				<p>The <code class="inline">--multree</code> flag is required in this case to let GRAMPA know that the input species tree is a MUL-tree.</p>

				<h3>Outputs</h3>

				<p>The above command would create the directory <code class="cb">ex3-output</code> with five output files</p>

				<ul>
					<li><a href="example_data/ex3/ex-3output/count-test-checknums.txt" download>count-test-checknums.txt</a></li>
					<li><a href="example_data/ex3/ex3-output/count-test-detailed.txt" download>count-test-detailed.txt</a></li>
                    <li><a href="example_data/ex3/ex3-output/count-test-dup-counts.txt" download>count-test-dup-counts.txt</a></li>
					<li><a href="example_data/ex3/ex3-output/count-test.log" download>count-test.log</a></li>
                    <li><a href="example_data/ex3/ex3-output/count-test-scores.txt" download>count-test-scores.txt</a></li>
				</ul>

				<p>Since we are trying to count duplications and losses, we are interested in the <code class="cb">count-test-detailed.txt</code> file. This file contains
					reconciliation scores for each gene tree to the lowest scoring MUL-tree (in this case, the only MUL-tree). The contents of the file look something
					like this:</p>

<pre><code>mul.tree        gene.tree       dups    losses  total.score
1       1       5       2       7
1       2       8       4       12
1       3       3       0       3
1       4       1       4       5
</code></pre>

				<p>Here you can see the exact number of duplications and losses for each gene tree when mapped to the lowest scoring MUL-tree, while properly 
                	counting multiple copies of the polyploid species (x,y,z) as either paralogs or homoeologs. Additionally, you could add the 
                    <code class="inline">--maps</code> flag to the command above to add another column to the detailed output file that shows the maps and
					duplication nodes in each gene tree (see the README section <a href="readme.html#--maps">--maps</a> for more info).
                </p>
                
                <p>Additionally, GRAMPA counts the total number of duplications across all gene trees for each node in the six lowest scoring trees. In this
                 	example, we only searched one tree so it only provides the duplication counts for that tree. These counts can
					be found in the <code class="cb">count-test-dup-counts.txt</code> file:
                </p>
                
<pre><code>mul.tree        node    dups
1       x*      102
1       y*      88
1       z*      193
1       B       234
1       A       344
1       C       232
1       x+      104
1       y+      87
1       z+      212
1       D       386
1       <1>     94
1       <2>     82
1       <3>     102
1       <4>     73
1       <5>     110
1       <6>     101
1       <7>     143
1       <8>     108
1       <9>     0
</code></pre>                
                
			</div>
		</div>
		<div class="col-3-24" id="margin"></div>
	</div>

        <div class="sep-div-2"></div>
    <div class="row" id="footer">
        <div class="col-1-1">
            <div id="footer_text">
                    <center>Site designed and maintained by <a href="https://gwct.github.io/" target="_blank">Gregg Thomas</a> | &copy; Copyright 2018-2025 Gregg Thomas | Page built: 01/22/2025 12:16:23 Eastern Standard Time</center>
            </div>
        </div>
    </div>
</body>
