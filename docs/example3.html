
<!doctype html>
    <head>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
            ga('create', 'UA-98263199-1', 'auto');
            ga('send', 'pageview');
        </script>
    
        <title>GRAMPA - Count</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">	
        <link type="text/css" rel="stylesheet" href="css/pure.css"  media="screen,projection" />
        <link type="text/css" rel="stylesheet" href="css/scaffold.css"  media="screen,projection" />
        <link rel='shortcut icon' href='img/favicon.ico' type='image/x-icon'/ >
    </head>

<body>
        <div class="pure-g" id="nav_row">
		<div class="pure-u-6-24" id="margin"></div>
		<div class="pure-u-18-24" id="nav_col">
			<a href="index.html"><img class="pure_img" id="logo_nav" src="img/logo-small.png"></a>
			<a class="title" href="index.html">GRAMPA</a>
			<div class="pure-menu pure-menu-horizontal" id="nav_bar">
				<ul class="pure-menu-list" id="nav_list">
					<li class="pure-menu-item"><a href="index.html" class="nav_link">Home</a></li>
					<li class="pure-menu-item"><a href="about.html" class="nav_link">About</a></li>
					<li class="pure-menu-item"><a href="readme.html" class="nav_link">README</a></li>
					<li class="pure-menu-item"><a href="https://github.com/gwct/grampa" target="_blank" class="nav_link">Download</a></li>
					<li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
						<a href="#" id="menuLink1" class="pure-menu-link">Examples</a>
							<ul class="pure-menu-children">
								<li class="pure-menu-item"><a href="example1.html" class="pure-menu-link">Identify mode of polyploidy</a></li>
								<li class="pure-menu-item"><a href="example2.html" class="pure-menu-link">Place WGD on phylogeny</a></li>
								<li class="pure-menu-item"><a href="#" class="pure-menu-link">Count duplications and losses</a></li>
							</ul>
					</li>
					<li class="pure-menu-item pure-menu-has-children pure-menu-allow-hover">
						<a href="#" id="menuLink1" class="pure-menu-link">Results</a>
							<ul class="pure-menu-children">
								<li class="pure-menu-item"><a href="results/yeast/yeast.html" class="pure-menu-link">Baker's Yeast</a></li>
								<li class="pure-menu-item"><a href="results/wheat/wheat_all.html" class="pure-menu-link">Bread Wheat</a></li>
								<li class="pure-menu-item"><a href="performance.html" class="pure-menu-link">Performance</a></li>
							</ul>
					</li>
					<li class="pure-menu-item"><a href="links.html" class="nav_link">Other links</a></li>
				</ul>

				<div class="mobile_dropdown" id="mobile_nav">
					<a href="#" id="nav_link_dropdown">Navigation</a>
					<div class="mobile_dropdown_links">
						<ul class="pure-menu-list">
							<li><a href="index.html" class="mobile_nav_link" id="active_drop">Home</a></li>
							<li><a href="about.html" class="mobile_nav_link">About</a></li>
							<li><a href="readme.html" class="mobile_nav_link">README</a></li>
							<li><a href="https://github.com/gwct/grampa" target="_blank" class="mobile_nav_link">Download</a></li>
							<li><a href="example1.html" class="mobile_nav_link">Example: Identify polyploidy</a></li>
							<li><a href="example2.html" class="mobile_nav_link">Example: Place WGD on phylogeny</a></li>
							<li><a href="#" class="mobile_nav_link">Example: Count dups and losses</a></li>
							<li><a href="links.html" class="mobile_nav_link">Other links</a></li>
					</div>
				</div>				
			</div>
		</div>
		<!-- <div class="pure-u-3-24" id="margin"></div> -->
	</div>

	<div class="pure-g"><div class="pure-u-1" id="divider_row"></div></div>

	<div class="pure-g" id="main_row">
		<div class="pure-u-3-24" id="margin"></div>
		<div class="pure-u-18-24" id="main_col">
			<div id="main_content">
				<h1>Count duplications and losses in the presence of polyploidy</h1>
				<h4>Below are the inputs, commands, and outputs to do an analysis with GRAMPA to count the number of duplications and losses in a set of gene trees
					in the presence of polyploidy. The inputs are based on simulated data. For more detailed info on the simulations check
					<a href="http://biorxiv.org/content/early/2017/03/21/058149" target="_blank">our paper</a>.</h4>

				<h3>Inputs</h3>
				<p>Suppose a hybridization event between the B and C lineages leading to the allopolyploid x,y,z clade has been identified. The MUL-tree representing this
					scenario is:</p>
				<img class="pure-img" id="logo_main" src="example_data/ex3/mul_tree.png">
				<p>GRAMPA can accurately count duplications and losses with this MUL-tree as input.</p>
				<ol>
					<li>MUL-tree: <a href="example_data/ex3/mul_tree_74_3a.tre" download>mul_tree_74_3a.tre</a></li>
					<li>Gene trees from your set of species (in this case 1000 gene trees simulated with gain and loss) : 
						<a href="example_data/ex3/gene_trees_3a.txt" download>gene_trees_3a.txt</a></li>
				</ol>

				<h3>GRAMPA command</h3>
				<p>With a known polyploidy scenario (MUL-tree), we can simply reconcile to that MUL-tree:</p>
				<pre><code class="gp_cmd">python grampa.py -s mul_tree_74_3a.tre 		-g gene_trees_3a.txt -o ex3_output -f count_test -v 0 --multree</code></pre>

				<p>The <code class="cb">--multree</code> flag is required in this case to let GRAMPA know that the input species tree is a MUL-tree.</p>

				<h3>Outputs</h3>
				<p>The above command would create the directory <code class="cb">ex3_output</code> with three output files</p>
				<ul>
					<li><a href="example_data/ex3/ex3_output/count_test_checknums.txt" download>count_test_checknums.txt</a></li>
					<li><a href="example_data/ex3/ex3_output/count_test_det.txt" download>count_test_det.txt</a></li>
					<li><a href="example_data/ex3/ex3_output/count_test_out.txt" download>count_test_out.txt</a></li>
				</ul>
				<p>Since we are trying to count duplications and losses, we are interested in the <code class="cb">count_test_det.txt</code> file. This file contains
					reconciliation scores for each gene tree to the lowest scoring MUL-tree (in this case, the only MUL-tree). The contents of the file look something
					like this:</p>

<pre><code># MT-1:((((((x*,y*)&lt;1&gt;,z*)&lt;2&gt;,B)&lt;3&gt;,A)&lt;4&gt;,(C,((x+,y+)&lt;5&gt;,z+)&lt;6&gt;)&lt;7&gt;)&lt;8&gt;,D)&lt;9&gt;
# GT/MT combo   # dups  # losses    Total score
GT-1 to MT-1    5   2   7
GT-2 to MT-1    8   4   12
GT-3 to MT-1    3   0   3
GT-4 to MT-1    1   4   5
.
.
.
GT-999 to MT-1  1   2   3
GT-1000 to MT-1 2   4   6
# Gene trees with multiple maps:    36
# Total parsimony score for MT-1: 5242
</code></pre>

				<p>The total score is reported here and in the main output file (count_test_out.txt), but with this output you can see the exact number of duplications and
					losses for each gene tree, while properly counting multiple copies of the polyploid species (x,y,z) as either paralogs or homoeologs. Additionally, you
					could add the <code class="cb">--maps</code> flag to the command above to add another column to the detailed output file that shows the maps and
					duplication nodes in each gene tree (see the README section <a href="readme.html#--maps">--maps</a> for more info).</p>
			</div>
		</div>
		<div class="pure-u-3-24" id="margin"></div>
	</div>

        <div class="pure-g"><div class="pure-u-1" id="divider_row"></div></div>
    <div class="pure-g" id="footer">
        <div class="pure-u-1">
            <div id="footer_text">
                    <center>Site designed and maintained by <a href="https://gwct.github.io/index.html" target="_blank">Gregg Thomas</a> | <a href="https://purecss.io/" target="_blank">Pure CSS</a> |
                        Page built: 12/01/2019 10:17:27 MST</center>
            </div>
        </div>
    </div>
</body>
