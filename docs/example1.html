
<!doctype html>
    <head>
        <script>
            (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
            })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
    
            ga('create', 'UA-98263199-1', 'auto');
            ga('send', 'pageview');
        </script>
    
        <title>GRAMPA - Identify</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1">	
        <!-- <link type="text/css" rel="stylesheet" href="css/pure.css"  media="screen,projection" /> -->
        <link type="text/css" rel="stylesheet" href="css/grid.css"  media="screen,projection" />
        <link type="text/css" rel="stylesheet" href="css/scaffold.css"  media="screen,projection" />
        <link rel='shortcut icon' href='img/favicon.ico' type='image/x-icon'/ >
    </head>

<body>
    	<!-- Desktop nav menu -->
	<div class="row" id="desktop-nav">
		<div class="col-3-24" id="margin"></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="index.html">Home</a></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="about.html">About</a></div>
		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="readme.html">README</a></div>
		
		<div class="col-3-24 dropdown" id="nav-link-cell">
			<a href="#" class="nav-link">Examples&#x21b4;</a>
			<div class="dropdown_container">
				<div class="dropdown_list_item"><a href="#" class="nav-link-drop">&#x26AC; Identify mode of polyploidy</a></div>
				<div class="dropdown_list_item"><a href="example2.html" class="nav-link-drop">&#x26AC; Place WGD on phylogeny</a></div>
				<div class="dropdown_list_item"><a href="example3.html" class="nav-link-drop">&#x26AC; Count duplications and losses</a></div>
			</div>
		</div>

		<div class="col-3-24 dropdown" id="nav-link-cell">
			<a href="#" class="nav-link">Results&#x21b4;</a>
			<div class="dropdown_container">
				<div class="dropdown_list_item"><a href="results/yeast/yeast.html" class="nav-link-drop">&#x26AC; Baker's Yeast</a></div>
				<div class="dropdown_list_item"><a href="results/wheat/wheat_all.html" class="nav-link-drop">&#x26AC; Bread Wheat</a></div>
				<div class="dropdown_list_item"><a href="performance.html" class="nav-link-drop">&#x26AC; Performance</a></div>
			</div>
		</div>

		<div class="col-3-24" id="nav-link-cell"><a class="nav-link" href="links.html">Links</a></div>
	
		<div class="col-3-24" id="margin"></div>
	</div>
	<!-- Desktop nav menu -->

	<!-- Mobile nav menu -->
	<div class="row" id="mobile_nav">
		<div class="col-24-24 dropdown" id="nav_link_cell">
			<a href="#" class="nav_link"><img id="mobile_logo_nav" src="img/nav.png"></a> <span id="nav-text">Navigation</span>
			<div class="dropdown_container mobile_drop">
				<div class="dropdown_list_item"><a href="index.html" id="mobile_nav_link" id="active_drop">Home</a></div>
				<div class="dropdown_list_item"><a href="about.html" id="mobile_nav_link">About</a></div>
				<div class="dropdown_list_item"><a href="readme.html" id="mobile_nav_link">README</a></div>
				<div class="dropdown_list_item"><a href="https://github.com/gwct/grampa" target="_blank" id="mobile_nav_link">Download</a></div>
				<div class="dropdown_list_item"><a href="#" id="mobile_nav_link">Example: Identify polyploidy</a></div>
				<div class="dropdown_list_item"><a href="example2.html" id="mobile_nav_link">Example: Place WGD on phylogeny</a></div>
				<div class="dropdown_list_item"><a href="example3.html" id="mobile_nav_link">Example: Count dups and losses</a></div>
				<div class="dropdown_list_item"><a href="links.html" id="mobile_nav_link">Other links</a></div>
			</div>
		</div>  
	</div>
	<!-- Mobile nav menu -->

	<div class="row" id="main_row">
		<div class="col-3-24" id="margin"></div>
		<div class="col-18-24" id="main_col">
			<div id="main_content">

				<h1>Infer presence and mode of polyploidy</h1>

				<h4>Below are the inputs, commands, and outputs to do several analyses with GRAMPA. The inputs are based on
					simulated data. For more detailed info on the simulations check
					<a href="https://doi.org/10.1093/sysbio/syx044" target="_blank">our paper</a>.</h4>
                
				<div id="msg-cont">
					<div id="msg">
						<div id="msg-banner">Note</div>
						<div id="msg-text">
							<p>
								The examples below call GRAMPA as <code class="inline">grampa</code> assuming it has been installed from bioconda. If you installed
								from source, see <a href="readme.html#source">usage details in the README</a>.
							</p>
							<p></p>
						</div>
					</div>
				</div>
                                    
				<div class="sep-div-2"></div>  

				<div class="row">
					<a name="allo"></a>
					<div class="col-1" id="jump_row">
						<center>
						<div id="jump_container">
							Jump to section:
							<a class="jump_link" href="#allo">Allopolyploidy</a>
							<a class="jump_link" href="#auto">Autopolyploidy</a>
							<a class="jump_link" href="#nop">No polyploidy</a>
						</div>
						</center>
					</div>
				</div>	

				<h1>Allopolyploidy</h1>

				<h3>Inputs</h3>

				<p>1000 gene trees were simulated with gain and loss using <a href="https://github.com/arvestad/jprime" target="_blank">JPrIME</a> based on the
					following allopolyploid-like MUL-tree:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/allo_3a/allo_m.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>				

				<p>In this scenario, lineages B and C hybridized to form an allopolyploid lineage that diversified into the x,y,z clade.</p>

				<p>We then remove one polyploid clade from the MUL-tree to get a singly-labeled tree as input for GRAMPA. This is the same topology as above, except
					that the x,y,z clade sister to C is removed. This is the type of tree that typical phylogenetic reconstruction programs would produce even in
					the presence of allopolyploidy:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/allo_3a/allo_s.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>				

				<p>So, the input files for this search are:</p>

				<ol>
					<li>Singly-labeled species tree: <a href="example_data/ex1/allo_3a/spec_tree_3a.tre" download>spec_tree_3a.tre</a></li>
					<li>1000 gene trees simulated from an allopolyploid MUL-tree: <a href="example_data/ex1/allo_3a/gene_trees_3a.txt" download>gene_trees_3a.txt</a></li>
				</ol>

				<h3>GRAMPA command</h3>

				<p>Since in reality we wouldn't know whether there is an allo-, auto-, or no polyploidy in this tree, we want GRAMPA to search all nodes as possible
					polyploid lineages. That means we don't specify <code class="inline">-h1</code> or <code class="inline">-h2</code>.

				<center><pre class="cmd"><code>grampa -s spec_tree_3a.tre -g gene_trees_3a.txt -o allo-example-output -f allo-test</code></pre></center>

				<h3>Outputs</h3>

				<p>The above command would create the directory <code class="cb">allo-example-output</code> with six output files</p>

				<ul>
					<li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test-checknums.txt" download>allo-test-checknums.txt</a></li>
					<li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test-detailed.txt" download>allo-test-detailed.txt</a></li>
                    <li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test-dup-counts.txt" download>allo-test-dup-counts.txt</a></li>
                    <li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test.log" download>allo-test.log</a></li>
					<li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test-scores.txt" download>allo-test-scores.txt</a></li>
					<li><a href="example_data/ex1/allo_3a/allo-example-output/allo-test-trees-filtered.txt" download>allo-test-trees-filtered.txt</a></li>
				</ul>

				<p>Since we are trying to determine the mode of polyploidy, we are interested in the <code class="cb">allo-test-scores.txt</code> file. This file contains
					the total reconciliation scores for each MUL-tree considered, sorted from lowest scoring tree to highest scoring tree, and looks something like this:</p>

<pre><code>mul.tree        h1.node h2.node score   labeled.tree
105     <2>     C       5018    ((((((x+,y+)<1>,z+)<2>,B)<3>,A)<4>,(C,((x*,y*)<5>,z*)<6>)<7>)<8>,D)<9>
113     <3>     C       5900    ((((((x+,y+)<1>,z+)<2>,B+)<3>,A)<4>,(C,(((x*,y*)<5>,z*)<6>,B*)<7>)<8>)<9>,D)<10>
119     <4>     C       6824    ((((((x+,y+)<1>,z+)<2>,B+)<3>,A+)<4>,(C,((((x*,y*)<5>,z*)<6>,B*)<7>,A*)<8>)<9>)<10>,D)<11>
122     <4>     <5>     6824    (((((((x+,y+)<1>,z+)<2>,B+)<3>,A+)<4>,C)<5>,((((x*,y*)<6>,z*)<7>,B*)<8>,A*)<9>)<10>,D)<11>
110     <2>     <5>     7306    (((((((x+,y+)<1>,z+)<2>,B)<3>,A)<4>,C)<5>,((x*,y*)<6>,z*)<7>)<8>,D)<9>
109     <2>     <4>     7435    (((((((x+,y+)<1>,z+)<2>,B)<3>,A)<4>,((x*,y*)<5>,z*)<6>)<7>,C)<8>,D)<9>
117     <3>     <5>     7616    (((((((x+,y+)<1>,z+)<2>,B+)<3>,A)<4>,C)<5>,(((x*,y*)<6>,z*)<7>,B*)<8>)<9>,D)<10>
</code></pre>

				<p>GRAMPA tells us MUL-tree 105 is the lowest scoring tree:</p>

				<center><code class="cb">((((((x+,y+)&lt;1&gt;,z+)&lt;2&gt;,B)&lt;3&gt;,A)&lt;4&gt;,(C,((x*,y*)&lt;5&gt;,z*)&lt;6&gt;)&lt;7&gt;)&lt;8&gt;,D)&lt;9&gt;</code></center>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/allo_3a/mt_74.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>Notice that this is the same topology that was used to simulate the gene-trees. GRAMPA has successfully identified an allopolyploid MUL-tree and
					placed the second polyploid lineage on the correct branch!</p>

				<div class="row">
					<a name="auto"></a>
					<div class="col-1" id="jump_row">
						<center>
						<div id="jump_container">
							Jump to section:
							<a class="jump_link" href="#allo">Allopolyploidy</a>
							<a class="jump_link" href="#auto">Autopolyploidy</a>
							<a class="jump_link" href="#nop">No polyploidy</a>
						</div>
						</center>
					</div>
				</div>	

				<h1>Autopolyploidy</h1>

				<p>1000 gene trees were simulated with gain and loss using <a href="https://github.com/arvestad/jprime" target="_blank">JPrIME</a> based on the
					following autopolyploid-like MUL-tree:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/auto_18/auto_m.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>In this scenario, a lineage sister to species C underwent autopolyploidization and subsequently diversified into the x,y,z clade.</p>

				<p>We then remove one polyploid clade from the MUL-tree to get a singly-labeled tree as input for GRAMPA. This is the same topology as above, except
					that one x,y,z clade is removed. This is the type of tree that typical phylogenetic reconstruction programs would produce even in
					the presence of autopolyploidy:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/auto_18/auto_s.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>So, the input files for this search are:</p>

				<ol>
					<li>Singly-labeled species tree: <a href="example_data/ex1/auto_18/spec_tree_18.tre" download>spec_tree_18.tre</a></li>
					<li>1000 gene trees simulated from an allopolyploid MUL-tree: <a href="example_data/ex1/auto_18/gene_trees_18.txt" download>gene_trees_18.txt</a></li>
				</ol>

				<h3>GRAMPA command</h3>

				<p>Since in reality we wouldn't know whether there is an allo-, auto-, or no polyploidy in this tree, we want GRAMPA to search all nodes as possible
					polyploid lineages. That means we don't specify <code class="cb">-h1</code> or <code class="cb">-h2</code>.

				<center><pre class="cmd"><code>grampa -s spec_tree_18.tre -g gene_trees_18.txt -o auto_example_output -f auto_test -v 0</code></pre></center>

				<h3>Outputs</h3>

				<p>The above command would create the directory <code class="cb">auto_example_output</code> with six output files</p>

				<ul>
					<li><a href="example_data/ex1/auto_18/auto-example-output/auto-test-checknums.txt" download>auto-test-checknums.txt</a></li>
					<li><a href="example_data/ex1/auto_18/auto-example-output/auto-test-detailed.txt" download>auto-test-detailed.txt</a></li>
                    <li><a href="example_data/ex1/auto_18/auto-example-output/auto-test-dup-counts.txt" download>auto-test-dup-counts.txt</a></li>
                    <li><a href="example_data/ex1/auto_18/auto-example-output/auto-test.log" download>auto-test.log</a></li>
					<li><a href="example_data/ex1/auto_18/auto-example-output/auto-test-scores.txt" download>auto-test-scores.txt</a></li>
					<li><a href="example_data/ex1/auto_18/auto-example-output/auto-test-trees-filtered.txt" download>auto-test-trees-filtered.txt</a></li>
				</ul>

				<p>Since we are trying to determine the mode of polyploidy, we are interested in the <code class="cb">auto-test-scores.txt</code> file. This file contains
					the total reconciliation scores for each MUL-tree considered, sorted from lowest scoring tree to highest scoring tree,  and looks something like this:</p>

<pre><code>mul.tree        h1.node h2.node score   labeled.tree
119     <3>     <3>     4807    (((B,A)<1>,((((x+,y+)<2>,z+)<3>,((x*,y*)<4>,z*)<5>)<6>,C)<7>)<8>,D)<9>
0       NA      NA      5476    (((B,A)<1>,(((x,y)<2>,z)<3>,C)<4>)<5>,D)<6>
85      D       D       5493    (((B,A)<1>,(((x,y)<2>,z)<3>,C)<4>)<5>,(D+,D*)<6>)<7>
105     <2>     z       5776    (((B,A)<1>,(((x+,y+)<2>,(z,(x*,y*)<3>)<4>)<5>,C)<6>)<7>,D)<8>
110     <2>     <3>     5776    (((B,A)<1>,((((x+,y+)<2>,z)<3>,(x*,y*)<4>)<5>,C)<6>)<7>,D)<8>
71      C       C       5812    (((B,A)<1>,(((x,y)<2>,z)<3>,(C+,C*)<4>)<5>)<6>,D)<7>
97      <1>     <1>     5817    ((((B+,A+)<1>,(B*,A*)<2>)<3>,(((x,y)<4>,z)<5>,C)<6>)<7>,D)<8>
</code></pre>

				<p>GRAMPA tells us MUL-tree 119 is the lowest scoring tree:</p>

				<center><code class="cb">(((B,A)&lt;1&gt;,((((x+,y+)&lt;2&gt;,z+)&lt;3&gt;,((x*,y*)&lt;4&gt;,z*)&lt;5&gt;)&lt;6&gt;,C)&lt;7&gt;)&lt;8&gt;,D)&lt;9&gt;</code></center>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/auto_18/mt_57.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>Notice that this is the same topology that was used to simulate the gene-trees, and that the h1 and h2 nodes of this MUL tree are the same, indicating
                	autopolyploidy. GRAMPA has successfully identified an autopolyploid MUL-tree on the correct branch!</p>

				<div class="row">
					<a name="nop"></a>
					<div class="col-1" id="jump_row">
						<center>
						<div id="jump_container">
							Jump to section:
							<a class="jump_link" href="#allo">Allopolyploidy</a>
							<a class="jump_link" href="#auto">Autopolyploidy</a>
							<a class="jump_link" href="#nop">No polyploidy</a>
						</div>
						</center>
					</div>
				</div>	

				<h1>No polyploidy</h1>

				<p>1000 gene trees were simulated with gain and loss <a href="https://github.com/arvestad/jprime" target="_blank">JPrIME</a> based on the
					following singly-labeled tree:</p>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/nop_33/nop_s.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>In this scenario, no polyploidy has occurred and this is the same tree we give to GRAMPA.</p>

				<p>So, the input files for this search are:</p>

				<ol>
					<li>Singly-labeled species tree: <a href="example_data/ex1/nop_33/spec_tree_33.tre" download>spec_tree_33.tre</a></li>
					<li>1000 gene trees simulated from an allopolyploid MUL-tree: <a href="example_data/ex1/nop_33/gene_trees_33.txt" download>gene_trees_33.txt</a></li>
				</ol>

				<h3>GRAMPA command</h3>

				<p>Since in reality we wouldn't know whether there is an allo-, auto-, or no polyploidy in this tree, we want GRAMPA to search all nodes as possible
					polyploid lineages. That means we don't specify <code class="inline">-h1</code> or <code class="inline">-h2</code>.

				<center><pre class="cmd"><code>grampa -s spec_tree_33.tre -g gene_trees_33.txt -o nop_example_output -f nop_test -v 0</code></pre></center>

				<h3>Outputs</h3>

				<p>The above command would create the directory <code class="cb">nop_example_output</code> with four output files</p>

				<ul>
					<li><a href="example_data/ex1/nop_33/nop-example-output/nop-test-checknums.txt" download>nop-test-checknums.txt</a></li>
					<li><a href="example_data/ex1/nop_33/nop-example-output/nop-test-detailed.txt" download>nop-test-detailed.txt</a></li>
                    <li><a href="example_data/ex1/nop_33/nop-example-output/nop-test-dup-counts.txt" download>nop-test-dup-counts.txt</a></li>
                    <li><a href="example_data/ex1/nop_33/nop-example-output/nop-test.log" download>nop-test.log</a></li>
					<li><a href="example_data/ex1/nop_33/nop-example-output/nop-test-scores.txt" download>nop-test-scores.txt</a></li>
					<li><a href="example_data/ex1/nop_33/nop-example-output/nop-test-trees-filtered.txt" download>nop-test-trees-filtered.txt</a></li>
				</ul>

				<p>Since we are trying to determine the mode of polyploidy, we are interested in the <code class="cb">nop-test-scores.txt</code> file. This file contains
					the total reconciliation scores for each MUL-tree considered, sorted from lowest scoring tree to highest scoring tree, and looks something like this:</p>

<pre><code>mul.tree        h1.node h2.node score   labeled.tree
0       NA      NA      4115    ((((((x,y)<1>,z)<2>,B)<3>,A)<4>,C)<5>,D)<6>
85      D       D       4217    ((((((x,y)<1>,z)<2>,B)<3>,A)<4>,C)<5>,(D+,D*)<6>)<7>
71      C       C       4370    ((((((x,y)<1>,z)<2>,B)<3>,A)<4>,(C+,C*)<5>)<6>,D)<7>
57      A       A       4423    ((((((x,y)<1>,z)<2>,B)<3>,(A+,A*)<4>)<5>,C)<6>,D)<7>
43      B       B       4554    ((((((x,y)<1>,z)<2>,(B+,B*)<3>)<4>,A)<5>,C)<6>,D)<7>
120     <4>     D       4558    ((((((x+,y+)<1>,z+)<2>,B+)<3>,A+)<4>,C)<5>,(D,((((x*,y*)<6>,z*)<7>,B*)<8>,A*)<9>)<10>)<11>
113     <3>     C       4632    ((((((x+,y+)<1>,z+)<2>,B+)<3>,A)<4>,(C,(((x*,y*)<5>,z*)<6>,B*)<7>)<8>)<9>,D)<10>
</code></pre>

				<p>GRAMPA tells us that the input species tree (<em>i.e.</em> the singly-labeled tree) is the lowest scoring tree:</p>

				<center><code class="cb">((((((x,y)&lt;1&gt;,z)&lt;2&gt;,B)&lt;3&gt;,A)&lt;4&gt;,C)&lt;5&gt;,D)&lt;6&gt;</code></center>

				<div class="row img-row">
					<div class="col-9-24 img-margin-left"></div>
					<div class="col-6-24 img-col">
						<img class="grid-img" src="example_data/ex1/nop_33/nop_s.png">
					</div>
					<div class="col-9-24 img-margin-right"></div>
				</div>	

				<p>Notice that this is the same topology that was used to simulate the gene-trees and contains no polyploidy events. GRAMPA has successfully 
                	determined that no polyploidy has occurred among these lineages!</p>
			</div>
		</div>
		<div class="col-3-24" id="margin"></div>
	</div>

        <div class="sep-div-2"></div>
    <div class="row" id="footer">
        <div class="col-1-1">
            <div id="footer_text">
                    <center>Site designed and maintained by <a href="https://gwct.github.io/" target="_blank">Gregg Thomas</a> | &copy; Copyright 2018-2025 Gregg Thomas | Page built: 01/22/2025 12:27:03 Eastern Standard Time</center>
            </div>
        </div>
    </div>
</body>
